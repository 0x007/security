## 认证缺陷
多数用户都在各个网站上使用同样的弱密码。如果您想您的应用程序不被攻击者暴力破解，应该设置一个较好的密码。好的密码应包含小写字母、大写字母和数字。密码越长，效果越好。
认证缺陷通常都是在密码设置，密码找回等问题上出现的。

### 使用场景
认证的应用几乎在互联网上无处不在。个人博客，SNS等社交网络上。

### 漏洞分析
认证的缺陷一般都是密码设置，密码找回。
- 0x01 密码设置

目前网络上存在一些明文保存密码的应用还是有不少，只是可能还没被暴露出来。
在目前网络上被拖库，暴露出来的数据当中分析，很多密码设置很简单。通常都是一个密码多出使用，只要一个web应用账户密码被破，该用户其他应用基本全都沦陷了。包括我自己也是
一个密码多处使用，不过我密码很长，我设置过最长密码是32位。后来懒得记了。很多本地的VM的密码就很简单。比如设置个什么`mimashishenme?`

- 0x02 密码找回

很多Web 应用程序的实施机制并不正确。验证用户身份所需要的信息往往过于简单。比如某个企鹅（Not Linux）通过回答问题的方式找回密码，我2-3个账号通过加对方好友，然后用其中一个聊天。查看对方信息，然后通过密码找回，回答问题，联系好友的方式，很容易就能重置对方的所有信息。
目前这个缺陷还是存在不过，没以前那么容易了。

一般目前的web应用都采取手机短信认证和邮件认证，安全相对来说非常高的，但是，手机一旦遗失，同样面临所有社交网络账号等信息全都沦陷。

- 0x03 登录认证

登录认证的漏洞都是由程序逻辑设计不合理造成的，比如使用cookie保存账号信息。还有就是不需要密码登录的情况，例如：
```php
<?php    
    
    var $username = $passwd = "";
    var $sql = "select * from users where ";
    if(isset($_GET['username']) && $_GET['username'] =='admin'){
        $username = "`users.username`='admin'";
    }else{
        die("username is empty!");
    }

    if(isset($_GET['passwd']) && $_GET['passwd'] == '123'){
        $passwd = "and `users.passwd`='123'";
    }

    if(isset($username) && isset($passwd)){
        $sql .= $username . $passwd;

    }else{
        die("username and passwd is empty!");
    }

    $sql += " limit 0,1";
    $query = mysql_query($sql);
    //...
?>
```
这样逻辑错误的代码就会造成，不输入密码就能登录进去。

### 危害
根据情况不同，危害的范围也不同。
密码过于简单，被破解的可能性越大，基本等于没有设置。
回答问题的密码找回，设置问题时，过于简单很容易被猜测出来。
登录认证逻辑错误，会造成越权访问，本来不是我的自己的账户我可以去访问，如果知晓管理员账户，就可以访问整个应用的数据了。

### 解决方案
密码越复杂，被成功猜解的代价也越高，代价通常以时间衡量。
回答问题找回密码，在设置答案时一定要注意隐私。设置只有自己知道的问题答案。一般建议密码找回用多重验证。比如回答问题加账号绑定的手机短信验证，或者邮件验证。
登录认证，最好严谨的测试登录流程。代码编写严谨，不要用cookie存储登录凭证。可用session/memcache等key/value内存数据库存储登录凭证（注意session的session劫持漏洞，请参考session劫持防御，避免被劫持）。